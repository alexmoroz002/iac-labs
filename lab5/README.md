# Лабораторная работа 5

## Цель работы

Закрепить понимание процесса написания ролей и их конфигурирования и развертывания

## Ход работы

1. Развернуть виртуальную машину для приложения (app) и виртуальную машину для будущей системы базы данных (db) через Vagrantfile
2. Написать роль установки **PostgreSQL** и плейбук, который ее разворачивает
3. Все параметры должны быть вынесены в переменные, все переменные должны быть префиксованы, значения переменных устанавливаются через group_vars для плейбука, роль должна быть покрыта тестами
4. Добавить возможность смены директории с данными на кастомную
5. Добавить возможность создания баз данных и пользователей
6. ***Добавить функционал настройки streaming-репликации***
7. ***Продумать логику определения master и replica нод СУБД и их настройки при работе роли***

## Запуск

Для запуска требуются два сервера на Ubuntu 20.02+ с установленным OpenSSH. IP серверов должен быть указан в inventory/hosts. Для корректного запуска и работы кластера в файле должны быть указаны обе группы master и replica

Перед запуском необходимо скачать роль [Postgres](https://gitlab.com/ansible-roles-iac/postgres)указанную в requirements.yaml, используя Ansible Galaxy - ansible-galaxy install -r requirements.yaml

Запуск плейбука осуществляется командой ansible-playbook -i inventory/hosts app.yaml